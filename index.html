<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="style.css">
    <meta charset="UTF-8">
    <title>Micro:bit BLELogger Console</title>
</head>

<body>
    <div class="box">
        <div class="row header">
                <button id="connect" class="button">Connect</button>
        </div>
        <div class="row header">
                <button id="disconnect" class="button">Disconnect All</button>
        </div>
        <div class="row header">
                <button id="clear" class="button">Clear Console</button>
        </div>

        <div id="console" class="row content" style="overflow:auto;border:4px solid black;padding:2%">
            Waiting for connection.
        </div>                            
    </div>
</body>

<!--  Include the DAP support library and WebUSB support -->
<script src="ubitwebblelog.js"></script>

<script>

    // Append a line to the console frame
    function consolePrintln(message) {
        var con = document.getElementById("console")
        con.innerHTML += "<br/>"+message
        con.scrollTop = con.scrollHeight
    }

    let uBM = new uBitManager()
    // Make the "go" button open the request devices box
    uBM.addEventListener("connected", (e)=> {
        console.log("New Device connected")
        console.dir(e)
        consolePrintln(`Connected to: ${e}`)
    })
    uBM.addEventListener("disconnected", (e)=> {
        console.log("Device disconnected")
        console.dir(e)
        consolePrintln(`Disconnected from: ${e}`)
    })
    document.getElementById("connect").addEventListener("click", () => uBM.connect())
    // document.getElementById("disconnect").addEventListener("click", () =>  { connectedDevices.forEach(d=>uBitDisconnect(d)); connectedDevices = [];})
    // document.getElementById("clear").addEventListener("click", () => { document.getElementById("console").innerHTML = "" })
    // document.getElementById("send").addEventListener("click", () => { connectedDevices.forEach( d=>uBitSend(d, "Test")) })

</script>

</html>
